"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8299],{21930:(e,t,a)=>{a.d(t,{a:()=>n,b:()=>o});var s=a(75358),r=a(89468),i=a(67073),n=class extends Error{static{(0,i.a)(this,"OramaClientNotInitializedError")}constructor(){super("Orama Client is not initialized")}},o=class{static{(0,i.a)(this,"ChatService")}constructor(e){this.sendQuestion=(e,t,a)=>{if(!this.oramaClient)throw new n;let s={term:e,related:{howMany:3,format:"question"}};return this.answerSession||(this.answerSession=this.oramaClient.createAnswerSession({events:{onStateChange:(0,i.a)(e=>{let t=e.filter(e=>!!e.query);r.b.interactions=t.map((t,i)=>{var n,o,h;let l=e.length-1===i,c=r.a.loading,d=[];return t.aborted?c=r.a.aborted:t.loading&&t.sources?c=r.a.rendering:t.loading&&t.response?c=r.a.streaming:!t.loading&&t.response&&(c=r.a.done),t.sources&&(d=Array.isArray(t.sources)?null===(n=t.sources)||void 0===n?void 0:n.map(e=>e.document):null===(o=t.sources.hits)||void 0===o?void 0:o.map(e=>e.document)),l&&c===r.a.done&&(null===(h=a?.onAnswerGeneratedCallback)||void 0===h||h.call(a,{askParams:s,query:t.query,sources:t.sources,answer:t.response,segment:t.segment,trigger:t.trigger})),{query:t.query,interactionId:t.interactionId,response:t.response,relatedQueries:t.relatedQueries,status:c,latest:l,sources:d}})},"onStateChange")}}),"cloud"===this.oramaClient.clientType&&t&&this.answerSession.setSystemPromptConfiguration({systemPrompts:t})),this.answerSession.ask(s).catch(e=>{r.b.interactions=r.b.interactions.map((e,t)=>t===r.b.interactions.length-1?Object.assign(Object.assign({},e),{status:r.a.error}):e),console.error(e)})},this.abortAnswer=()=>{if(!this.answerSession)throw new n;this.answerSession.abortAnswer()},this.regenerateLatest=async()=>{if(!this.answerSession)throw new n;this.answerSession.regenerateLast({stream:!1})},this.resetChat=async()=>{if(!this.answerSession)throw new n;r.b.interactions.length<1||(["loading","rendering","streaming"].includes(r.b.interactions[r.b.interactions.length-1].status)&&this.answerSession.abortAnswer(),this.answerSession.clearSession())},this.oramaClient=new s.a(e)}}},58571:(e,t,a)=>{a.d(t,{a:()=>r,b:()=>i});var s=(0,a(142).a)({open:!1,currentTask:"search",currentTerm:""}),{state:r}=s,i=function(e,t){var a={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&0>t.indexOf(s)&&(a[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,s=Object.getOwnPropertySymbols(e);r<s.length;r++)0>t.indexOf(s[r])&&Object.prototype.propertyIsEnumerable.call(e,s[r])&&(a[s[r]]=e[s[r]]);return a}(s,["state"])},142:(e,t,a)=>{a.d(t,{a:()=>p});var s=a(60223),r=a(67073),i=(0,r.a)((e,t,a)=>{let s=e.get(t);s?s.includes(a)||s.push(a):e.set(t,[a])},"appendToMap"),n=(0,r.a)((e,t)=>{let a;return(...s)=>{a&&clearTimeout(a),a=setTimeout(()=>{a=0,e(...s)},t)}},"debounce"),o=(0,r.a)(e=>!("isConnected"in e)||e.isConnected,"isConnected"),h=n(e=>{for(let t of e.keys())e.set(t,e.get(t).filter(o))},2e3),l=(0,r.a)(()=>{if("function"!=typeof s.f)return{};let e=new Map;return{dispose:(0,r.a)(()=>e.clear(),"dispose"),get:(0,r.a)(t=>{let a=(0,s.f)();a&&i(e,t,a)},"get"),set:(0,r.a)(t=>{let a=e.get(t);a&&e.set(t,a.filter(s.g)),h(e)},"set"),reset:(0,r.a)(()=>{e.forEach(e=>e.forEach(s.g)),h(e)},"reset")}},"stencilSubscription"),c=(0,r.a)(e=>"function"==typeof e?e():e,"unwrap"),d=(0,r.a)((e,t=(e,t)=>e!==t)=>{let a=c(e),s=new Map(Object.entries(a??{})),i={dispose:[],get:[],set:[],reset:[]},n=(0,r.a)(()=>{var t;s=new Map(Object.entries(null!==(t=c(e))&&void 0!==t?t:{})),i.reset.forEach(e=>e())},"reset"),o=(0,r.a)(()=>{i.dispose.forEach(e=>e()),n()},"dispose"),h=(0,r.a)(e=>(i.get.forEach(t=>t(e)),s.get(e)),"get"),l=(0,r.a)((e,a)=>{let r=s.get(e);t(a,r,e)&&(s.set(e,a),i.set.forEach(t=>t(e,a,r)))},"set"),d=typeof Proxy>"u"?{}:new Proxy(a,{get:(e,t)=>h(t),ownKeys:e=>Array.from(s.keys()),getOwnPropertyDescriptor:()=>({enumerable:!0,configurable:!0}),has:(e,t)=>s.has(t),set:(e,t,a)=>(l(t,a),!0)}),p=(0,r.a)((e,t)=>(i[e].push(t),()=>{u(i[e],t)}),"on");return{state:d,get:h,set:l,on:p,onChange:(0,r.a)((t,a)=>{let s=p("set",(e,s)=>{e===t&&a(s)}),r=p("reset",()=>a(c(e)[t]));return()=>{s(),r()}},"onChange"),use:(0,r.a)((...e)=>{let t=e.reduce((e,t)=>(t.set&&e.push(p("set",t.set)),t.get&&e.push(p("get",t.get)),t.reset&&e.push(p("reset",t.reset)),t.dispose&&e.push(p("dispose",t.dispose)),e),[]);return()=>t.forEach(e=>e())},"use"),dispose:o,reset:n,forceUpdate:(0,r.a)(e=>{let t=s.get(e);i.set.forEach(a=>a(e,t,t))},"forceUpdate")}},"createObservableMap"),u=(0,r.a)((e,t)=>{let a=e.indexOf(t);a>=0&&(e[a]=e[e.length-1],e.length--)},"removeFromArray"),p=(0,r.a)((e,t)=>{let a=d(e,t);return a.use(l()),a},"createStore")},38764:(e,t,a)=>{a.d(t,{a:()=>r});var s=(0,a(142).a)({count:0,facets:[],facetProperty:"",results:[],resultMap:{},highlightedIndex:-1,loading:!1,error:!1,searchService:null,searchParams:null}),{state:r}=s;!function(e,t){var a={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&0>t.indexOf(s)&&(a[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,s=Object.getOwnPropertySymbols(e);r<s.length;r++)0>t.indexOf(s[r])&&Object.prototype.propertyIsEnumerable.call(e,s[r])&&(a[s[r]]=e[s[r]])}(s,["state"])},89468:(e,t,a)=>{a.d(t,{a:()=>s,b:()=>n,c:()=>o});var s,r=a(142);!function(e){e.idle="idle",e.loading="loading",e.rendering="rendering",e.streaming="streaming",e.error="error",e.aborted="aborted",e.done="done"}(s||(s={}));var i=(0,r.a)({chatService:null,interactions:[],sourceBaseURL:"",linksTarget:"_blank",linksRel:"noopener noreferrer",sourcesMap:{title:"title",description:"description",path:"path"}}),{state:n}=i,o=function(e,t){var a={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&0>t.indexOf(s)&&(a[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,s=Object.getOwnPropertySymbols(e);r<s.length;r++)0>t.indexOf(s[r])&&Object.prototype.propertyIsEnumerable.call(e,s[r])&&(a[s[r]]=e[s[r]]);return a}(i,["state"])},38299:(e,t,a)=>{a.r(t),a.d(t,{orama_search_box:()=>p});var s=a(21930),r=a(38764),i=a(58571),n=a(75358),o=a(89468);a(142);var h=a(60223),l=a(67073),c=function(e,t){var a={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&0>t.indexOf(s)&&(a[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,s=Object.getOwnPropertySymbols(e);r<s.length;r++)0>t.indexOf(s[r])&&Object.prototype.propertyIsEnumerable.call(e,s[r])&&(a[s[r]]=e[s[r]]);return a},d=class{static{(0,l.a)(this,"SearchService")}constructor(e){this.search=async(e,t,a)=>{var i;if(!this.oramaClient)throw new s.a;if(this.abortSearch(),!e){r.a.results=[],r.a.count=0,r.a.facets=[],r.a.highlightedIndex=-1;return}r.a.loading=!0;let n=this.abortController,o=null!==(i=r.a.searchParams)&&void 0!==i?i:{},{limit:h,offset:l,where:d}=o,u=Object.assign(Object.assign(Object.assign(Object.assign({},c(o,["limit","offset","where"])),{term:e,limit:h||10}),d?{where:d}:{}),r.a.facetProperty&&Object.assign({facets:{[r.a.facetProperty]:{}}},t&&"All"!==t&&{where:Object.assign({[r.a.facetProperty]:{eq:t}},d)}));await this.oramaClient.search(u,{abortController:this.abortController}).then(e=>{var t;n.signal.aborted||(r.a.results=this.parserResults(e?.hits,r.a.resultMap),r.a.count=e?.count||0,r.a.facets=this.parseFacets(e?.facets,r.a.facetProperty),r.a.highlightedIndex=-1,r.a.loading=!1,null===(t=a?.onSearchCompletedCallback)||void 0===t||t.call(a,{clientSearchParams:u,result:{results:r.a.results,resultsCount:r.a.count,facets:r.a.facets}}))}).catch(e=>{var t;r.a.loading=!1,null===(t=a?.onSearchErrorCallback)||void 0===t||t.call(a,e)})},this.retry=()=>{throw Error("Not implemented")},this.parserResults=(e,t)=>{if(!e)return[];let a=[],s={};for(let r of e){let e=this.hitToSearchResultParser(r,t),i="function"==typeof t.section?t.section(r.document):t.section,n=r.document[i];void 0===s[n]?(a.push({section:n,items:[e]}),s[n]=a.length-1):a[s[n]].items.push(e)}return a},this.hitToSearchResultParser=(e,t)=>{function a(a){let s=t[a];if(!s)return e.document[a];if("function"==typeof s)return s(e.document);let r=t[a];return e.document[r]}return(0,l.a)(a,"getResultMapValue"),{id:e.id,score:e.score,title:a("title"),description:a("description"),path:a("path")}},this.parseFacets=(e,t)=>{var a;if(!t||!e||!(!(null===(a=e[t])||void 0===a)&&a.values))return[];let s=e[t],r=Object.values(s.values).reduce((e,t)=>e+t,0),i=Object.keys(s.values).map(e=>({name:e,count:s.values[e]}));return i.unshift({name:"All",count:r}),i},this.oramaClient=new n.a(e),this.abortController=new AbortController}abortSearch(){this.abortController.abort(),this.abortController=new AbortController}},u=new class extends EventTarget{static{(0,l.a)(this,"WindowService")}constructor(){super(),this._width=window.innerWidth,this.handleResize=this.handleResize.bind(this),window.addEventListener("resize",this.handleResize)}handleResize(){this._width=window.innerWidth,this.dispatchEvent(new CustomEvent("widthChange",{detail:this._width}))}get width(){return this._width}},p=class{static{(0,l.a)(this,"SearchBox")}constructor(e){(0,h.a)(this,e),this.searchCompleted=(0,h.e)(this,"searchCompleted",7),this.searchResultClick=(0,h.e)(this,"searchResultClick",7),this.answerGenerated=(0,h.e)(this,"answerGenerated",7),this.answerSourceClick=(0,h.e)(this,"answerSourceClick",7),this.chatMarkdownLinkClicked=(0,h.e)(this,"chatMarkdownLinkClicked",7),this.closeSearchbox=()=>{i.a.open=!1,this.open=!1},this.onChatButtonClick=()=>{i.a.currentTask="chat"},this.onPrefersColorSchemeChange=e=>{this.systemScheme=e.matches?"dark":"light",this.updateTheme()},this.updateWindowWidth=e=>{this.windowWidth=e.detail},this.themeConfig=void 0,this.colorScheme="light",this.index=void 0,this.clientInstance=void 0,this.open=!1,this.facetProperty=void 0,this.resultMap={},this.sourceBaseUrl=void 0,this.linksTarget=void 0,this.linksRel=void 0,this.sourcesMap=void 0,this.disableChat=!1,this.layout="modal",this.highlightTitle=!1,this.highlightDescription=!1,this.placeholder=void 0,this.chatPlaceholder=void 0,this.searchPlaceholder=void 0,this.suggestions=void 0,this.searchParams=void 0,this.chatMarkdownLinkTitle=void 0,this.chatMarkdownLinkHref=void 0,this.chatMarkdownLinkTarget=void 0,this.componentID=(0,n.g)("search-box"),this.systemScheme="light",this.windowWidth=void 0}indexChanged(){this.startServices()}watchHandler(){this.updateTheme()}handleOpenPropChange(e){i.a.open=e}handleFacetPropertyChange(e){r.a.facetProperty=e}handleSearchParamsChange(e){r.a.searchParams=e}modalStatusChangedHandler(e){e.detail.id===this.wrapperRef&&(e.detail.open||(i.a.open=!1,this.open=!1))}handleKeyDown(e){"search"===i.a.currentTask&&("modal"===this.layout&&this.open||"embed"===this.layout)&&["ArrowDown","ArrowUp"].includes(e.key)&&(0,n.b)(this.wrapperRef,e)}updateTheme(){let e="system"===this.colorScheme?this.systemScheme:this.colorScheme,t=this.htmlElement;t&&e&&(t.classList.remove("theme-light","theme-dark"),t.classList.add(`theme-${e}`)),this.updateCssVariables(e)}updateCssVariables(e){var t;let a=this.themeConfig,s=this.htmlElement;if(s&&a&&e){if(!(null===(t=a.colors)||void 0===t)&&t[e])for(let t of Object.keys(a.colors[e]))s.style.setProperty(`${t}`,a.colors[e][t]);if(a.typography)for(let e of Object.keys(a.typography))s.style.setProperty(`${e}`,a.typography[e])}}startServices(){(0,n.e)(this.htmlElement,this.index,this.clientInstance);let e=this.clientInstance?this.clientInstance:(0,n.f)(this.index);r.a.searchService=new d(e),o.b.chatService=new s.b(e)}componentWillLoad(){r.a.facetProperty=this.facetProperty,r.a.resultMap=this.resultMap,r.a.searchParams=this.searchParams,this.htmlElement.id=this.componentID,this.startServices()}connectedCallback(){this.windowWidth=u.width,i.a.open=this.open,i.b.onChange("open",()=>{this.open=i.a.open,i.a.open||(i.a.currentTerm="",r.a.facets=[],r.a.count=0,r.a.results=[],r.a.highlightedIndex=-1,r.a.loading=!1,r.a.error=!1,o.b.interactions=[])}),this.htmlElement.id=this.componentID,this.schemaQuery=window.matchMedia("(prefers-color-scheme: dark)"),this.systemScheme=this.schemaQuery.matches?"dark":"light",this.updateTheme(),this.schemaQuery.addEventListener("change",this.onPrefersColorSchemeChange),u.addEventListener("widthChange",this.updateWindowWidth)}disconnectedCallback(){var e;u.removeEventListener("widthChange",this.updateWindowWidth),null===(e=this.schemaQuery)||void 0===e||e.removeEventListener("change",this.onPrefersColorSchemeChange)}getSearchBox(){return(0,h.b)("div",{class:`${this.windowWidth>1024||"search"===i.a.currentTask?"section-active":"section-inactive"}`},(0,h.b)("orama-search",{placeholder:(this===null||void 0===this?void 0:this.searchPlaceholder)||"Search...",focusInput:"search"===i.a.currentTask,sourceBaseUrl:this.sourceBaseUrl,linksTarget:this.linksTarget,linksRel:this.linksRel,highlightTitle:this.highlightTitle,highlightDescription:this.highlightDescription,disableChat:this.disableChat,suggestions:this.suggestions},this.windowWidth>1024&&!this.disableChat&&(0,h.b)("orama-chat-button",{slot:"summary","focus-on-arrow-nav":!0,active:!!i.a.currentTerm,label:`${i.a.currentTerm?`${i.a.currentTerm} - `:""}Get a summary`,onClick:this.onChatButtonClick,onKeyPress:this.onChatButtonClick})))}getChatBox(){return(0,h.b)(h.i,null,(0,h.b)("orama-chat",{class:`${"chat"===i.a.currentTask?"section-active":"section-inactive"}`,defaultTerm:"chat"===i.a.currentTask?i.a.currentTerm:"",showClearChat:!1,focusInput:"chat"===i.a.currentTask,placeholder:(this===null||void 0===this?void 0:this.chatPlaceholder)||this.placeholder,sourceBaseUrl:this.sourceBaseUrl,linksTarget:this.linksTarget,linksRel:this.linksRel,sourcesMap:this.sourcesMap,suggestions:this.suggestions,chatMarkdownLinkTitle:this.chatMarkdownLinkTitle,chatMarkdownLinkHref:this.chatMarkdownLinkHref}))}getInnerContent(){return(0,h.b)(h.i,null,this.disableChat?null:(0,h.b)("orama-navigation-bar",{handleClose:this.closeSearchbox,showBackButton:"embed"!==this.layout,showChatActions:"chat"===i.a.currentTask}),(0,h.b)("div",{class:"main"},this.getSearchBox(),this.windowWidth<=1024&&this.getChatBox()),(0,h.b)("orama-footer",{colorScheme:"system"===this.colorScheme?this.systemScheme:this.colorScheme}))}getOuterContent(){return this.windowWidth>1024?(0,h.b)("orama-sliding-panel",{open:"chat"===i.a.currentTask,backdrop:"embed"===this.layout,closed:(0,l.a)(()=>{i.a.currentTask="search"},"closed")},this.getChatBox()):null}getModalLayout(){return(0,h.b)(h.i,null,(0,h.b)("orama-modal",{ref:(0,l.a)(e=>this.wrapperRef=e,"ref"),open:i.a.open,class:"modal",mainTitle:"Start your search",closeOnEscape:"search"===i.a.currentTask||this.windowWidth<=1024},this.getInnerContent()),this.getOuterContent())}getEmbedLayout(){return(0,h.b)(h.i,null,(0,h.b)("orama-embed",{ref:(0,l.a)(e=>this.wrapperRef=e,"ref")},this.getInnerContent()),this.getOuterContent())}render(){return"modal"!==this.layout||i.a.open?r.a.searchService?o.b.chatService?"modal"===this.layout?this.getModalLayout():this.getEmbedLayout():(0,h.b)("orama-text",{as:"p"},"Unable to initialize chat service"):(0,h.b)("orama-text",{as:"p"},"Unable to initialize search service"):null}get htmlElement(){return(0,h.d)(this)}static get watchers(){return{index:["indexChanged"],clientInstance:["indexChanged"],themeConfig:["watchHandler"],colorScheme:["watchHandler"],open:["handleOpenPropChange"],facetProperty:["handleFacetPropertyChange"],searchParams:["handleSearchParamsChange"]}}};p.style="@keyframes showIn{0%{opacity:0;transform:translateY(-25%)}to{opacity:1;transform:translateY(0)}}@media (min-width:1024.02px){.modal orama-input{border-radius:0;margin:0;padding:0}.modal input[type=search]{border-radius:.75rem .75rem 0 0;border-radius:var(--radius-m,calc(12rem/var(--orama-base-font-size, 16))) var(--radius-m,calc(12rem/var(--orama-base-font-size, 16))) 0 0}}.main{flex-direction:column;flex-grow:1}.main,.section-active{display:flex;overflow:hidden}.section-inactive{display:none}"}}]);